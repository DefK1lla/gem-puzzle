{"version":3,"sources":["node_modules/browser-pack/_prelude.js","app/js/main.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","module","fieldOffset","cellSize","cellsCount","numbers","interval","moves","time","CLICK_AUDIO","Audio","isAudio","_JSON$parse","JSON","parse","localStorage","getItem","emptyCell","top","left","value","cells","createBtns","isStarted","arguments","undefined","btns","document","createElement","className","restartBtn","innerHTML","addEventListener","handleStart","saveBtn","disabled","handleSave","resultsBtn","handleResultsShow","toggleAudio","handleAudioToggle","append","removeItem","startGame","game","querySelector","split","Math","pow","emptyIndex","findIndex","cell","splice","setItem","stringify","stopInterval","body","table","results","concat","map","res","index","createResultsTable","target","classList","toggle","createStatsBar","start","seconds","statsBar","floor","setInterval","clearInterval","createCell","position","draggable","style","width","height","push","elem","isCellInteractive","moveCell","handleCellClick","preventDefault","requestAnimationFrame","visibility","handleDragStart","_getConditions2","getConditions","xCondition","yCondition","handleDragEnd","_getConditions","targetTouches","handleTouchEnd","emptyPos","dragPos","pageX","pageY","abs","handleSizeChange","play","currentLeft","currentTop","isFinished","every","sqrt","_moves","_time","prevResults","sort","b","slice","saveResults","prevCells","_game$cellsCount","_game$moves","_game$time","find","_toConsumableArray","Array","keys","x","random","unshift","field","FIELD_WIDTH","_cell","ondragover","createField","getBoundingClientRect","diffuclty","size","difficulty","difficultyCurrent","difficultyList","difficultyItem","difficultyLink","href","difficultyOther","createDifficultyPanel"],"mappings":"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","file":"../main.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","const FIELD_WIDTH = 320;\nconst CLICK_AUDIO = new Audio('./audio/click.mp3');\n\nlet isAudio = JSON.parse(localStorage.getItem('isAudio')) ?? true;\n\nlet emptyCell = {\n  top: 0,\n  left: 0,\n  value: 0\n};\n\nlet cells = [];\ncells.push(emptyCell);\n\nlet fieldOffset;\nlet cellSize;\nlet cellsCount;\nlet numbers;\nlet interval;\nlet moves;\nlet time;\n\n\nfunction createResultsTable() {\n  const table = document.createElement('table');\n  const results = JSON.parse(localStorage.getItem('results'));\n\n  table.innerHTML = `\n    <tr>\n      <th>Position</th>\n      <th>Moves</th>\n      <th>Time</th>\n    </tr>\n\n    ${!results\n      ? `\n        <tr>\n          <td colspan=\"3\">\n            <p class=\"results-placeholder\">You have never won</p>\n          </td>\n        </tr>\n      `\n      : results.map((res, index) => (`\n        <tr>\n          <td>${index + 1}</td>\n          <td>${res.moves}</td>\n          <td>${res.time}</td>\n        </tr>\n      `))\n    }\n  `;\n\n  return table;\n}\n\nfunction createBtns(isStarted = true) {\n  const btns = document.createElement('div');\n  btns.className = 'btns';\n\n  const restartBtn = document.createElement('button');\n  restartBtn.className = 'btn';\n  restartBtn.innerHTML = 'Start';\n  restartBtn.addEventListener('click', handleStart);\n\n  const saveBtn = document.createElement('button');\n  saveBtn.className = 'btn';\n  saveBtn.innerHTML = 'Save';\n  saveBtn.disabled = !isStarted;\n  saveBtn.addEventListener('click', handleSave);\n\n  const resultsBtn = document.createElement('button');\n  resultsBtn.className = 'btn';\n  resultsBtn.innerHTML = 'Results';\n  resultsBtn.addEventListener('click', handleResultsShow);\n\n  const toggleAudio = document.createElement('button');\n  toggleAudio.className = isAudio ? 'btn active' : 'btn';\n  toggleAudio.innerHTML = 'Sound';\n  toggleAudio.addEventListener('click', handleAudioToggle);\n\n  btns.append(restartBtn, saveBtn, resultsBtn, toggleAudio);\n\n  return btns;\n}\n\nfunction handleStart(e) {\n  moves = 0;\n  time = 0;\n  localStorage.removeItem('game');\n  startGame();\n}\n\nfunction handleSave(e) {\n  const game = {};\n\n  game.moves = document.querySelector('.stats__moves span').innerHTML;\n\n  const time = document.querySelector('.stats__time span').innerHTML.split(':');\n  game.time = time[0] * 60 + time[1];\n\n  game.cellsCount = document.querySelector('.difficulty__current span').innerHTML.split('x')[0] ** 2;\n  game.cells = cells;\n\n  const emptyIndex = game.cells.findIndex(cell => cell.value === 0);\n  game.cells.splice(emptyIndex, 1, emptyCell);\n\n  localStorage.setItem('game', JSON.stringify(game));\n}\n\nfunction handleResultsShow(e) {\n  stopInterval();\n  document.body.innerHTML = '';\n\n  const btns = createBtns(false);\n  document.body.append(btns);\n\n  const table = createResultsTable();\n  document.body.append(table);\n}\n\nfunction handleAudioToggle(e) {\n  e.target.classList.toggle('active');\n  isAudio = !isAudio;\n  localStorage.setItem('isAudio', isAudio);\n}\n\nfunction createStatsBar() {\n  const statsBar = document.createElement('div');\n  statsBar.className = 'stats';\n\n  statsBar.innerHTML = `\n    <div class=\"stats__moves\">\n      Moves: <span>${moves ? moves : 0}</span>\n    </div>\n\n    <div class=\"stats__time\">\n      Time: <span>${time ? Math.floor(time / 60) + ':' + (time % 60 > 10 ? time % 60 : '0' + time % 60) : '0:0'}</span>\n    </div>\n  `;\n\n  startInterval(time);\n\n  return statsBar;\n}\n\nfunction startInterval(start) {\n  let seconds = start ?? 0;\n  interval = setInterval(() => {\n    const time = document.querySelector('.stats__time span');\n    seconds++;\n    time.innerHTML = `${Math.floor(seconds / 60)}:${seconds % 60 < 10 ? '0' + seconds % 60 : seconds % 60}`;\n  }, 1000);\n}\n\nfunction stopInterval() {\n  clearInterval(interval);\n  interval = null;\n}\n\nfunction createField(prevCells) {\n  cellSize = FIELD_WIDTH / Math.sqrt(cellsCount);\n  const field = document.createElement('div');\n  field.className = 'field';\n  field.style.width = FIELD_WIDTH + 'px';\n  field.style.height = FIELD_WIDTH + 'px';\n\n  for (let i = 0; i < cellsCount; i++) {\n    if (prevCells && prevCells[i]) {\n      if (prevCells[i].value === 0) continue;\n      const cell = createCell(i, prevCells[i].value, cellSize, prevCells[i], cellsCount);\n      field.append(cell);\n    } else {\n      const position = {\n        left: i % Math.sqrt(cellsCount),\n        top: (i - (i % Math.sqrt(cellsCount))) / Math.sqrt(cellsCount),\n      };\n      const value = numbers[i];\n      if (value === 0) continue;\n\n      const cell = createCell(i, value, cellSize, position, cellsCount);\n      field.append(cell);\n    }\n  }\n  field.ondragover = e => e.preventDefault();\n  return field;\n}\n\nfunction createCell(index, value, cellSize, position) {\n  const cell = document.createElement('div');\n  cell.className = 'cell';\n  cell.draggable = true;\n\n  cell.style.width = cellSize + 'px';\n  cell.style.height = cellSize + 'px';\n  cell.style.left = position.left * cellSize + 'px';\n  cell.style.top = position.top * cellSize + 'px';\n\n  cells.push({\n    left: position.left,\n    top: position.top,\n    value,\n    elem: cell\n  });\n\n  cell.innerHTML = value;\n\n  cell.addEventListener('click', (e) => handleCellClick(e, index));\n  cell.addEventListener('dragstart', (e) => handleDragStart(e, index));\n  cell.addEventListener('dragend', (e) => handleDragEnd(e, index));\n  cell.addEventListener('touchmove', (e) => handleTouchEnd(e, index));\n\n\n  return cell;\n};\n\nfunction getConditions(e) {\n  const emptyPos = {\n    left: emptyCell.left * cellSize,\n    top: emptyCell.top * cellSize\n  };\n  const dragPos = {\n    left: e.pageX - fieldOffset.left,\n    top: e.pageY - fieldOffset.top\n  }\n  const xCondition = dragPos.left >= emptyPos.left && dragPos.left <= emptyPos.left + cellSize,\n    yCondition = dragPos.top >= emptyPos.top && dragPos.top <= emptyPos.top + cellSize;\n\n  return {\n    xCondition,\n    yCondition\n  };\n}\n\nfunction handleTouchEnd(e, index) {\n  e.preventDefault();\n\n  const cell = cells[index];\n  if (isCellInteractive(cell)) return e.preventDefault();\n\n  const touch = e.targetTouches[0]\n  const { xCondition, yCondition } = getConditions(touch);\n\n  if (xCondition && yCondition) moveCell(index);\n}\n\nfunction handleDragStart(e, index) {\n  const cell = cells[index];\n  if (isCellInteractive(cell)) return e.preventDefault();\n  requestAnimationFrame(() => cell.elem.style.visibility = 'hidden', 0);\n}\n\nfunction handleDragEnd(e, index) {\n  const cell = cells[index];\n\n  const { xCondition, yCondition } = getConditions(e);\n\n  if (xCondition && yCondition) moveCell(index);\n  requestAnimationFrame(() => cell.elem.style.visibility = 'visible', 0);\n}\n\nfunction isCellInteractive(cell) {\n  const leftDiff = Math.abs(emptyCell.left - cell.left),\n    topDiff = Math.abs(emptyCell.top - cell.top);\n  return leftDiff + topDiff > 1;\n}\n\nfunction handleCellClick(e, index) {\n  const cell = cells[index];\n\n  if (isCellInteractive(cell)) return;\n  moveCell(index);\n}\n\nfunction createDifficultyPanel(size) {\n  size = size ? Math.sqrt(size) + 'x' + Math.sqrt(size) : '4x4';\n\n  const difficulty = document.createElement('div');\n  difficulty.className = 'difficulty';\n\n  const difficultyCurrent = document.createElement('div');\n  difficultyCurrent.className = 'difficulty__current';\n  difficultyCurrent.innerHTML = `Frame size: <span>${size}</span>`;\n\n  difficulty.append(difficultyCurrent);\n\n  const difficultyList = document.createElement('ul');\n  difficultyList.className = 'difficulty__list';\n\n  for (let i = 3; i < 9; i++) {\n    const difficultyItem = document.createElement('li');\n    difficultyItem.className = 'difficulty__item';\n\n    const difficultyLink = document.createElement('a');\n    difficultyLink.href = '#';\n    difficultyLink.className = 'difficulty__link';\n    difficultyLink.innerHTML = i + 'x' + i;\n\n    difficultyLink.addEventListener('click', handleSizeChange);\n\n    difficultyItem.append(difficultyLink);\n    difficultyList.append(difficultyItem);\n  }\n\n  const difficultyOther = document.createElement('div');\n  difficultyOther.className = 'difficulty__other';\n  difficultyOther.innerHTML = 'Other sizes: ';\n  difficultyOther.append(difficultyList);\n\n  difficulty.append(difficultyOther);\n\n  return difficulty;\n};\n\nfunction handleSizeChange(e) {\n  e.preventDefault();\n  cellsCount = e.target.innerHTML.split('x')[0] ** 2;\n  moves = 0;\n  time = 0;\n  localStorage.removeItem('game');\n  startGame();\n}\n\nfunction moveCell(index) {\n  const cell = cells[index];\n\n  document.querySelector('.stats__moves span').innerHTML++;\n\n  if (isAudio) CLICK_AUDIO.play();\n\n  cell.elem.style.left = emptyCell.left * cellSize + 'px';\n  cell.elem.style.top = emptyCell.top * cellSize + 'px';\n\n  const currentLeft = cell.left,\n    currentTop = cell.top;\n\n  cell.left = emptyCell.left;\n  cell.top = emptyCell.top;\n\n  emptyCell.left = currentLeft;\n  emptyCell.top = currentTop;\n\n  const isFinished = cells.every(cell => {\n    if (cell === emptyCell) return true;\n\n    return emptyCell.top === 0 && emptyCell.left === 0\n      ? cell.value === cell.top * Math.sqrt(cellsCount) + cell.left\n      : cell.value === (cell.top * Math.sqrt(cellsCount) + cell.left) + 1;\n  });\n\n  if (isFinished) {\n    stopInterval();\n    const moves = document.querySelector('.stats__moves span').innerHTML,\n      time = document.querySelector('.stats__time span').innerHTML;\n    document.querySelector('.field').innerHTML = `Hooray! You solved the puzzle in ${time} and ${moves} moves!`;\n    saveResults(moves, time);\n  }\n}\n\nfunction saveResults(moves, time) {\n  const prevResults = localStorage.getItem('results');\n  const results = prevResults ? JSON.parse(prevResults) : [];\n  results.push({ moves, time });\n  localStorage.setItem('results', JSON.stringify(results.sort((a, b) => b.moves - a.moves)).slice(0, 11));\n}\n\nfunction startGame() {\n  const game = JSON.parse(localStorage.getItem('game'));\n  let prevCells;\n  if (game) {\n    cellsCount = game?.cellsCount ?? 16;\n    moves = game?.moves ?? 0;\n    time = game?.time ?? 0;\n    emptyCell = game.cells.find(cell => cell.value === 0);\n    prevCells = game.cells;\n  } else {\n    emptyCell = {\n      top: 0,\n      left: 0,\n      value: 0\n    };\n    cells = [];\n    cells.push(emptyCell);\n  }\n\n  if (!cellsCount) cellsCount = 16;\n\n  numbers = [...new Array(cellsCount - 1).keys()]\n    .map(x => x + 1)\n    .sort((a, b) => Math.random() - 0.5);\n  numbers.unshift(0);\n\n  document.body.innerHTML = '';\n  stopInterval();\n\n  const btns = createBtns();\n  document.body.append(btns);\n\n  const statsBar = createStatsBar();\n  document.body.append(statsBar);\n\n  const field = createField(prevCells);\n  document.body.append(field);\n  fieldOffset = {\n    left: field.getBoundingClientRect().left,\n    top: field.getBoundingClientRect().top\n  };\n\n  const diffuclty = createDifficultyPanel(cellsCount);\n  document.body.append(diffuclty);\n}\n\nfunction init() {\n  startGame();\n}\n\ndocument.addEventListener('DOMContentLoaded', init);"]}